##### https://zhuanlan.zhihu.com/p/43789231
##### https://www.upyun.com/tech/article/192/1.html

1. 浏览器请求服务器
2. 服务器发送ca证书给浏览器
ca证书中包括：证书的公钥，证书明文信息，私密（hash(证书明文信息)）得到的 数字签名，具体的hash方法
3. 浏览器验证证书身份+验证证书是否被篡改
是否被篡改验证方法：
s1 = 通过传过来的hash方法，hash(证书明文信息)
s2 = 证书公钥(数字签名)
s1 === s2 => ca证书未被篡改
4. 浏览器发送 证书公钥(自己随机生成的 私钥) 给服务器
5. 服务器使用ca证书私钥解密 得到浏览器秘钥
浏览器秘钥 = ca证书私钥(证书公钥(浏览器自己随机生成的私钥))
6. 浏览器、服务器 通过浏览器秘钥，对称加密通信

##### 非对称加密原理：
某网站服务器拥有公钥A与对应的私钥A’；浏览器拥有公钥B与对应的私钥B’。。
浏览器把公钥B明文传输给服务器。
服务器把公钥A明文给传输浏览器。
之后浏览器向服务器传输的内容都用公钥A加密，服务器收到后用私钥A’解密。由于只有服务器拥有私钥A’，所以能保证这条数据的安全。
同理，服务器向浏览器传输的内容都用公钥B加密，浏览器收到后用私钥B’解密。同上也可以保证这条数据的安全。

##### 非对称加密+对称加密
既然非对称加密耗时，那非对称加密+对称加密结合可以吗？而且得尽量减少非对称加密的次数。当然是可以的，且非对称加密、解密各只需用一次即可。
请看一下这个过程：

某网站拥有用于非对称加密的公钥A、私钥A’。
浏览器向网站服务器请求，服务器把公钥A明文给传输浏览器。
浏览器随机生成一个用于对称加密的密钥X，用公钥A加密后传给服务器。
服务器拿到后用私钥A’解密得到密钥X。
这样双方就都拥有密钥X了，且别人无法知道它。之后双方所有数据都通过密钥X加密解密即可。
完美！HTTPS基本就是采用了这种方案。完美？还是有漏洞的。

##### CA机构，它是如今互联网世界正常运作的前提，而CA机构颁发的“身份证”就是数字证书。
数字证书
网站在使用HTTPS前，需要向CA机构申领一份数字证书，数字证书里含有证书持有者信息、公钥信息等。服务器把证书传输给浏览器，浏览器从证书里获取公钥就行了，证书就如身份证，证明“该公钥对应该网站”。

##### 如何放防止数字证书被篡改？ 数字签名
我们把证书原本的内容生成一份“签名”，比对证书内容和签名是否一致就能判别是否被篡改。这就是数字证书的“防伪技术”，这里的“签名”就叫数字签名

##### 每次进行HTTPS请求时都必须在SSL/TLS层进行握手传输密钥吗？
这也是我当时的困惑之一，显然每次请求都经历一次密钥传输过程非常耗时，那怎么达到只传输一次呢？

服务器会为每个浏览器（或客户端软件）维护一个session ID，在TSL握手阶段传给浏览器，浏览器生成好密钥传给服务器后，服务器会把该密钥存到相应的session ID下，之后浏览器每次请求都会携带session ID，服务器会根据session ID找到相应的密钥并进行解密加密操作，这样就不必要每次重新制作、传输密钥了！
